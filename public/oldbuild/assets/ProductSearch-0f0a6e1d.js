import{r,j as e,S as I,x as U}from"./app-aef64c69.js";import{M as A}from"./MainLayout-e41de4fa.js";import{P as O}from"./ProductGrid-de76c976.js";import{C as k}from"./CategoryFillterSideBar-b08bb954.js";import{P as J}from"./Pagination-e0030041.js";import"./RatingStar-31131bbe.js";function se({general:o,headerMenu:L,footerMenu4:C,footerMenu3:E,categoryMenu:R,auth:T,products:d,category:p,footerMenu2:$,carts:M,attributes:j,subCtg:b,maxPrice:m}){const[H,w]=r.useState(!1),[q,B]=r.useState(1),u=new URLSearchParams(window.location.search).get("search");console.log(u);const v=r.useRef(!0),[l,y]=r.useState({category:[],color:[],attribute:[],fabric:[],size:[],cut_fit:[],min_price:0,max_price:m,sort_by:"latest",search:u,page:1}),[h,D]=r.useState(d),[_,V]=r.useState({total:d.total,from:d.from,to:d.to}),f=m,N=s=>s/f*100,x=s=>{const{name:t,value:a,checked:c,type:Q}=s.target;console.log(s.target),y(i=>["category","color","fabric","size","cut_fit"].includes(t)?{...i,[t]:c?[...i[t],a]:i[t].filter(G=>G!==a)}:t==="min_price"||t==="max_price"?{...i,[t]:a!==""?parseFloat(a):null}:t==="sort_by"?{...i,[t]:a}:i)},z=async()=>{w(!0);try{const s=new URLSearchParams(l),t=p?p.slug:"search",a=await fetch(`/product/filter/${t}?${s}`,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const c=await a.json();D(c.products),B(c.last_page),V({total:c.products.total,from:c.products.from,to:c.products.to}),console.log(c)}catch(s){console.error("Error fetching filtered data:",s.message)}finally{w(!1)}};r.useEffect(()=>{v.current?v.current=!1:z()},[l]);const[n,S]=r.useState(!1),g=r.useRef(null),P=()=>{S(!n)};r.useEffect(()=>{const s=t=>{g.current&&!g.current.contains(t.target)&&n&&S(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[n]),r.useEffect(()=>{n?document.body.classList.add("offcanvas__filter--sidebar_active"):document.body.classList.remove("offcanvas__filter--sidebar_active")},[n]);const F=s=>{y(t=>({...t,page:s}))};return e.jsxs(A,{auth:T,general:o,headerMenu:L,footerMenu4:C,footerMenu3:E,categoryMenu:R,footerMenu2:$,carts:M,children:[e.jsxs(I,{title:`Search - ${o.web_title}`,children:[e.jsx("meta",{name:"title",property:"og:title",content:`Search - ${o.web_title}`}),e.jsx("meta",{name:"description",property:"og:description",content:o.meta_description}),e.jsx("meta",{name:"keyword",property:"og:keyword",content:o.meta_keyword}),e.jsx("meta",{name:"image",property:"og:image",content:o.logo_url}),e.jsx("meta",{name:"url",property:"og:url",content:route("search")}),e.jsx("link",{rel:"canonical",href:route("search")})]}),e.jsx("section",{className:"breadcrumb__section breadcrumb__bg",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row row-cols-1",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"breadcrumb__content text-center",children:[e.jsxs("h1",{className:"breadcrumb__content--title text-white mb-25",children:["Search: ",u]}),e.jsxs("ul",{className:"breadcrumb__content--menu d-flex justify-content-center",children:[e.jsx("li",{className:"breadcrumb__content--menu__items",children:e.jsx(U,{className:"text-white",href:route("index"),children:"Home "})}),e.jsx("li",{className:"breadcrumb__content--menu__items",children:e.jsxs("span",{className:"text-white",children:["Search: ",u]})})]})]})})})})}),e.jsx("section",{className:"shop__section section--padding",children:e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"shop__header bg__gray--color d-flex align-items-center justify-content-between mb-30",children:[e.jsx("button",{className:"widget__filter--btn d-flex d-lg-none align-items-center",onClick:P,children:e.jsx("span",{className:"widget__filter--btn__text",children:"Filter "})}),e.jsx("div",{className:"product__view--mode d-flex align-items-center",children:e.jsxs("div",{className:"product__view--mode__list product__short--by align-items-center d-none d-lg-flex",children:[e.jsx("label",{className:"product__view--label",children:"Sort By : "}),e.jsx("div",{className:"select shop__header--select",children:e.jsxs("select",{className:"form-select product__view--select",name:"sort_by",onChange:x,children:[e.jsx("option",{value:"latest",children:"Sort by latest "}),e.jsx("option",{value:"high",children:"Price (High To Low)"}),e.jsx("option",{value:"low",children:"Price (Low To High)"})]})})]})}),e.jsxs("p",{className:"product__showing--count",children:["Showing ",_.from," - ",_.to,"  of ",_.total," results "]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-xl-3 col-lg-4",children:e.jsx("div",{className:"shop__sidebar--widget widget__area d-none d-lg-block",children:e.jsx(k,{handleCheckboxChange:x,filters:l,maxRange:f,getPercentage:N,attributes:j,subCtg:b,maxPrice:m})})}),e.jsx("div",{className:"col-xl-9 col-lg-8",children:e.jsx("div",{className:"shop__product--wrapper",children:H?e.jsx("p",{className:"text-center",children:"Loading..."}):e.jsx(e.Fragment,{children:h.data.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"product__section--inner product__grid--inner",children:e.jsx("div",{className:"row row-cols-xl-4 row-cols-lg-3 row-cols-md-3 row-cols-2 mb--n30",children:h.data.map((s,t)=>e.jsx("div",{className:"col mb-30",children:e.jsx(O,{product:s})},t))})}),e.jsx(J,{pagination:h,currentPage:l.page,totalPages:q,onPageChange:F})]}):e.jsx("div",{className:"text-center",children:"No products found"})})})})]})]})}),e.jsxs("div",{ref:g,class:`offcanvas__filter--sidebar widget__area ${n?"active":""}`,children:[e.jsxs("button",{type:"button",class:"offcanvas__filter--close",onClick:P,children:[e.jsx("svg",{class:"minicart__close--icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"currentColor",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144M368 144L144 368"})})," ",e.jsx("span",{class:"offcanvas__filter--close__text",children:"Close"})]}),e.jsx("div",{class:"offcanvas__filter--sidebar__inner",children:e.jsx(k,{handleCheckboxChange:x,filters:l,maxRange:f,getPercentage:N,attributes:j,subCtg:b,maxPrice:m})})]})]})}export{se as default};
