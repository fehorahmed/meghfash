import{u as $,r as a,j as e,S as z,x as G}from"./app-aef64c69.js";import{P as U}from"./ProductGrid-de76c976.js";import{M as V}from"./MainLayout-e41de4fa.js";import{a as W}from"./index-ed8b0840.js";import{S as B}from"./index-bf5016b7.js";import"./RatingStar-31131bbe.js";import"./index-a34fe7c7.js";function ee({general:i,headerMenu:S,footerMenu4:w,footerMenu3:C,footerMenu2:k,categoryMenu:T,auth:q,carts:o,latestProducts:_,pixelData:c}){var b,f;const{cart:t,initializeCart:d,removeFromCart:N}=$(),[E,J]=a.useState(o.cartsCount),[L,K]=a.useState(o.wlCount),[h,p]=a.useState(""),[O,m]=a.useState(!1),[x,P]=a.useState(""),[j,R]=a.useState(!1);a.useEffect(()=>{d(o)},[o]),a.useEffect(()=>{d(o)},[p]),a.useEffect(()=>{c&&(typeof fbq<"u"?fbq("track",c.event_name,{...c.custom_data,...c.user_data,event_id:c.event_id,event_time:c.event_time,event_source_url:c.event_source_url,action_source:c.action_source},{eventID:c.event_id}):console.warn("fbq not defined â€” check that Pixel script is loaded."))},[c]);var A={dots:!1,infinite:!0,autoplay:!0,speed:1e3,slidesToShow:4,slidesToScroll:4,initialSlide:0,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3,infinite:!0,dots:!0}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2,initialSlide:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]};const u=(s,r)=>{N(s,r)},F=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),M=async s=>{s.preventDefault(),m(!0);try{const r=await fetch("/my-coupon-apply",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":F},body:JSON.stringify({coupon_code:h})});if(!r.ok)throw new Error("Network response was not ok");const n=await r.json();P(n.message),R(n.success),n.carts&&d(n.carts),console.log("Server response:",n)}catch(r){console.error("Error:",r.message)}finally{m(!1)}},y=a.useRef(!0);return a.useEffect(()=>{var n,v;if(y.current){y.current=!1;return}if(!t)return;const s=l=>l.variants&&l.variants.length>0?l.variants.map(g=>`${g.title}:${g.value}`).join(","):null,r=(n=t==null?void 0:t.cartItems)==null?void 0:n.map(l=>({item_id:l.productId,item_name:l.productName,index:l.index||0,item_category:null,item_variant:s(l),price:parseInt(l.subTotal.match(/\d+[\d,.]*/)[0].replace(/,/g,"")),quantity:l.quantity}));window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"view_cart",currency:i.currency,value:t.grandTotal,coupon:(v=t==null?void 0:t.myCoupon)==null?void 0:v.name,items:r}),console.log("cart data layer call")},[t]),e.jsx(e.Fragment,{children:e.jsxs(V,{auth:q,general:i,headerMenu:S,footerMenu4:w,footerMenu3:C,categoryMenu:T,itemsCount:E,carts:o,wishListCount:L,footerMenu2:k,children:[e.jsxs(z,{title:`My Cart - ${i.web_title}`,children:[e.jsx("meta",{name:"title",property:"og:title",content:`My Cart - ${i.web_title}`}),e.jsx("meta",{name:"description",property:"og:description",content:i.meta_description}),e.jsx("meta",{name:"keyword",property:"og:keyword",content:i.meta_keyword}),e.jsx("meta",{name:"image",property:"og:image",content:i.logo_url}),e.jsx("meta",{name:"url",property:"og:url",content:route("carts")}),e.jsx("link",{rel:"canonical",href:route("carts")})]}),e.jsx("section",{class:"cart__section section--padding",children:e.jsx("div",{class:"container-fluid",children:e.jsx("div",{class:"cart__section--inner",children:e.jsxs("div",{action:"#",children:[e.jsx("h2",{class:"cart__title mb-40",children:"Shopping Cart "}),((b=t==null?void 0:t.cartItems)==null?void 0:b.length)>0?e.jsxs("div",{class:"row",children:[e.jsx("div",{class:"col-lg-8",children:e.jsx("div",{class:"cart__table",children:e.jsxs("table",{class:"cart__table--inner",children:[e.jsx("thead",{class:"cart__table--header",children:e.jsxs("tr",{class:"cart__table--header__items",children:[e.jsx("th",{class:"cart__table--header__list",children:"Product "}),e.jsx("th",{class:"cart__table--header__list",children:"Price "}),e.jsx("th",{class:"cart__table--header__list",children:"Quantity "}),e.jsx("th",{class:"cart__table--header__list",children:"Total "})]})}),e.jsx("tbody",{class:"cart__table--body",children:(f=t==null?void 0:t.cartItems)==null?void 0:f.map(s=>{var r;return e.jsxs("tr",{class:"cart__table--body__items",children:[e.jsx("td",{class:"cart__table--body__list",children:e.jsxs("div",{class:"cart__product d-flex align-items-center",children:[e.jsx("button",{onClick:()=>u(s.id,"delete"),class:"cart__remove--btn","aria-label":"search button",type:"button",children:e.jsx(W,{})}),e.jsx("div",{class:"cart__thumbnail",children:e.jsx("img",{class:"border-radius-5",src:s.productImage,alt:"cart-product"})}),e.jsxs("div",{class:"cart__content",children:[e.jsx("h4",{class:"cart__content--title",children:s.productName.length>25?`${s.productName.slice(0,25)}...`:s.productName}),(r=s==null?void 0:s.variants)==null?void 0:r.map(n=>e.jsxs("span",{class:"cart__content--variant",children:[" ",n.title,": ",n.value," "]}))]})]})}),e.jsx("td",{class:"cart__table--body__list",children:e.jsxs("span",{class:"cart__price",children:[s.finalPrice," "]})}),e.jsx("td",{class:"cart__table--body__list",children:e.jsxs("div",{class:"quantity__box",children:[e.jsx("button",{onClick:()=>u(s.id,"decrement"),type:"button",class:"quantity__value quickview__value--quantity decrease","aria-label":"quantity value",value:"Decrease Value",children:"- "}),e.jsx("label",{children:e.jsx("input",{type:"number",class:"quantity__number quickview__value--number",value:s.quantity})}),e.jsx("button",{onClick:()=>u(s.id,"increment"),type:"button",class:"quantity__value quickview__value--quantity increase","aria-label":"quantity value",value:"Increase Value",children:"+ "})]})}),e.jsx("td",{class:"cart__table--body__list",children:e.jsxs("span",{class:"cart__price end",children:[s.subTotal," "]})})]},s.id)})})]})})}),e.jsx("div",{class:"col-lg-4",children:e.jsxs("div",{class:"cart__summary border-radius-10",children:[e.jsxs("div",{class:"coupon__code mb-30",children:[e.jsx("h3",{class:"coupon__code--title",children:"Coupon "}),e.jsx("p",{class:"coupon__code--desc",children:"Enter your coupon code if you have one. "}),j==!0&&e.jsx("p",{style:{color:"green"},children:x}),j==!1&&e.jsx("p",{style:{color:"red",fontSize:"13px"},children:x}),e.jsx("div",{class:"coupon__code--field d-flex",children:e.jsxs("form",{className:"d-flex",onSubmit:M,children:[e.jsx("label",{children:e.jsx("input",{class:"coupon__code--field__input border-radius-5",value:h,placeholder:"Coupon code",type:"text",onChange:s=>p(s.target.value)})}),e.jsx("button",{class:"coupon__code--field__btn primary__btn",type:"submit",children:O?e.jsx("div",{class:"spinner-border ",role:"status"}):" Apply Coupon "})]})})]}),e.jsx("div",{class:"cart__summary--total mb-20",children:e.jsx("table",{class:"cart__summary--total__table",children:e.jsxs("tbody",{children:[e.jsxs("tr",{class:"cart__summary--total__list",children:[e.jsx("td",{class:"cart__summary--total__title text-left",children:"SUBTOTAL "}),e.jsxs("td",{class:"cart__summary--amount text-right",children:[" ",t==null?void 0:t.cartTotalPriceFormat," "]})]}),e.jsxs("tr",{class:"cart__summary--total__list",children:[e.jsx("td",{class:"cart__summary--total__title text-left",children:"DISCOUNT "}),e.jsxs("td",{class:"cart__summary--amount text-right",children:[" ",t==null?void 0:t.couponDiscFormat]})]}),e.jsxs("tr",{class:"cart__summary--total__list",children:[e.jsx("td",{class:"cart__summary--total__title text-left",children:"GRAND TOTAL "}),e.jsxs("td",{class:"cart__summary--amount text-right",children:[t==null?void 0:t.grandTotalFormat," "]})]})]})})}),e.jsx("div",{class:"cart__summary--footer",children:e.jsx("ul",{class:"d-flex justify-content-between",children:e.jsx("li",{children:e.jsx(G,{class:"cart__summary--footer__btn primary__btn checkout",href:route("checkout"),children:"Check Out "})})})})]})})]}):e.jsx("div",{style:{textAlign:"center",fontSize:"40px",fontWeight:"bold",color:"gray",margin:"100px 0"},children:"Cart is empty"})]})})})}),e.jsx("section",{class:"product__section section--padding pt-0 cart",children:e.jsxs("div",{class:"container-fluid",children:[e.jsx("div",{class:"section__heading text-center mb-50",children:e.jsx("h2",{class:"section__heading--maintitle",children:"New Products "})}),_.length>0&&e.jsx("div",{className:"slider-container ",children:e.jsx(B,{...A,children:_.map((s,r)=>e.jsx(U,{product:s}))})})]})})]})})}export{ee as default};
