import{r,j as e,S as J,x as P}from"./app-aef64c69.js";import{M as K}from"./MainLayout-e41de4fa.js";import{P as Q}from"./ProductGrid-de76c976.js";import{C as S}from"./CategoryFillterSideBar-b08bb954.js";import{P as W}from"./Pagination-e0030041.js";import"./RatingStar-31131bbe.js";function re({general:c,headerMenu:L,footerMenu4:E,footerMenu3:R,categoryMenu:$,auth:T,category:t,products:m,footerMenu2:M,carts:q,attributes:g,subCtg:b,maxPrice:u,pixelData:i}){const[F,v]=r.useState(!1),[H,I]=r.useState(1),[X,V]=r.useState(1),w=r.useRef(!0),[a,N]=r.useState({category:[],color:[],attribute:[],fabric:[],size:[],cut_fit:[],min_price:0,max_price:u,sort_by:"latest",page:1}),[_,B]=r.useState(m),[f,z]=r.useState({total:m.total,from:m.from,to:m.to});r.useEffect(()=>{i&&(typeof fbq<"u"?fbq("track",i.event_name,{...i.custom_data,...i.user_data,event_id:i.event_id,event_time:i.event_time,event_source_url:i.event_source_url,action_source:i.action_source},{eventID:i.event_id}):console.warn("fbq not defined â€” check that Pixel script is loaded."))},[i]);const h=u,k=s=>s/h*100,x=s=>{const{name:n,value:o,checked:O,type:Y}=s.target;N(d=>["category","color","fabric","size","cut_fit"].includes(n)?{...d,[n]:O?[...d[n],o]:d[n].filter(U=>U!==o)}:n==="min_price"||n==="max_price"?{...d,[n]:o!==""?parseFloat(o):null}:n==="sort_by"?{...d,[n]:o}:d)},G=async()=>{v(!0);try{const s=new URLSearchParams(a),n=await fetch(`/product/filter/${t.slug}?${s}`,{method:"GET",headers:{Accept:"application/json"}});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.json();B(o.products),I(o.last_page),z({total:o.products.total,from:o.products.from,to:o.products.to})}catch(s){console.error("Error fetching filtered data:",s.message)}finally{v(!1)}};r.useEffect(()=>{w.current?w.current=!1:G()},[a]);const[l,y]=r.useState(!1),p=r.useRef(null),C=()=>{y(!l)};r.useEffect(()=>{const s=n=>{p.current&&!p.current.contains(n.target)&&l&&y(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[l]),r.useEffect(()=>{l?document.body.classList.add("offcanvas__filter--sidebar_active"):document.body.classList.remove("offcanvas__filter--sidebar_active")},[l]);const j=r.useRef(null),A=s=>{N(n=>({...n,page:s})),j.current&&j.current.scrollIntoView({behavior:"smooth",block:"start"}),V(s)};return console.log(a),e.jsx(e.Fragment,{children:e.jsxs(K,{auth:T,general:c,headerMenu:L,footerMenu4:E,footerMenu3:R,categoryMenu:$,footerMenu2:M,carts:q,children:[e.jsxs(J,{title:t.seo_title?t.seo_title:`${t.name} - ${c.web_title}`,children:[e.jsx("meta",{name:"title",property:"og:title",content:t.seo_title?t.seo_title:`${t.name} - ${c.web_title}`}),e.jsx("meta",{name:"description",property:"og:description",content:t.seo_description?t.seo_description:c.meta_description}),e.jsx("meta",{name:"keyword",property:"og:keyword",content:t.seo_keyword?t.seo_keyword:c.meta_keyword}),e.jsx("meta",{name:"image",property:"og:image",content:t.meta_image?t.meta_image:c.logo_url}),e.jsx("meta",{name:"url",property:"og:url",content:route("productCategory",t.slug?t.slug:"no-title")}),e.jsx("link",{rel:"canonical",href:route("productCategory",t.slug?t.slug:"no-title")})]}),e.jsx("section",{className:"breadcrumb__section breadcrumb__bg",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row row-cols-1",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"breadcrumb__content text-center",children:[e.jsx("h1",{className:"breadcrumb__content--title text-white mb-25",children:t.name}),e.jsxs("ul",{className:"breadcrumb__content--menu d-flex justify-content-center",children:[e.jsx("li",{className:"breadcrumb__content--menu__items",children:e.jsx(P,{className:"text-white",href:route("index"),children:"Home "})}),t.parentCtgs.length>0&&e.jsx(e.Fragment,{children:t.parentCtgs.map(s=>e.jsx("li",{className:"breadcrumb__content--menu__items",children:e.jsxs(P,{className:"text-white",href:route("productCategory",s.slug?s.slug:"no-title"),children:[" ",s.name," "]})}))}),e.jsx("li",{className:"breadcrumb__content--menu__items",children:e.jsx("span",{className:"text-white",children:t.name})})]})]})})})})}),e.jsx("section",{className:"shop__section section--padding",ref:j,children:e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"shop__header bg__gray--color d-flex align-items-center justify-content-between mb-30",children:[e.jsx("button",{className:"widget__filter--btn d-flex d-lg-none align-items-center",onClick:C,children:e.jsx("span",{className:"widget__filter--btn__text",children:"Filter "})}),e.jsx("div",{className:"product__view--mode d-flex align-items-center",children:e.jsxs("div",{className:"product__view--mode__list product__short--by align-items-center d-none d-lg-flex",children:[e.jsx("label",{className:"product__view--label",children:"Sort By : "}),e.jsx("div",{className:"select shop__header--select",children:e.jsxs("select",{className:"form-select product__view--select",name:"sort_by",onChange:x,children:[e.jsx("option",{value:"latest",children:"Sort by latest "}),e.jsx("option",{value:"high",children:"Price (High To Low)"}),e.jsx("option",{value:"low",children:"Price (Low To High)"})]})})]})}),e.jsxs("p",{className:"product__showing--count",children:["Showing ",f.from," - ",f.to,"  of ",f.total," results "]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-xl-3 col-lg-4",children:e.jsx("div",{className:"shop__sidebar--widget widget__area d-none d-lg-block",children:e.jsx(S,{handleCheckboxChange:x,filters:a,maxRange:h,getPercentage:k,attributes:g,subCtg:b,maxPrice:u})})}),e.jsx("div",{className:"col-xl-9 col-lg-8",children:e.jsx("div",{className:"shop__product--wrapper",children:F?e.jsx("p",{className:"text-center",children:"Loading..."}):e.jsx(e.Fragment,{children:_.data.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"product__section--inner product__grid--inner",children:e.jsx("div",{className:"row row-cols-xl-4 row-cols-lg-3 row-cols-md-3 row-cols-2 mb--n30",children:_.data.map((s,n)=>e.jsx("div",{className:"col mb-30",children:e.jsx(Q,{product:s})},n))})}),e.jsx(W,{pagination:_,currentPage:a.page,totalPages:H,onPageChange:A})]}):e.jsx("div",{className:"text-center",children:"No products found"})})})})]})]})}),e.jsxs("div",{ref:p,class:`offcanvas__filter--sidebar widget__area ${l?"active":""}`,children:[e.jsxs("button",{type:"button",class:"offcanvas__filter--close",onClick:C,children:[e.jsx("svg",{class:"minicart__close--icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"currentColor",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144M368 144L144 368"})})," ",e.jsx("span",{class:"offcanvas__filter--close__text",children:"Close"})]}),e.jsx("div",{class:"offcanvas__filter--sidebar__inner",children:e.jsx(S,{handleCheckboxChange:x,filters:a,maxRange:h,getPercentage:k,attributes:g,subCtg:b,maxPrice:u})})]})]})})}export{re as default};
